"use strict";function debounce(e,t,n){var i;return function(){var a=this,r=arguments,o=n&&!i;clearTimeout(i),i=setTimeout(function(){i=null,n||e.apply(a,r)},t),o&&e.apply(a,r)}}window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=function(e,t){t=t||window;for(var n=0;n<this.length;n++)e.call(t,this[n],n,this)});var UxisViewer=function(e){return this.url=e.url,this.mode=e.mode||"one",this.target=document.querySelector(e.target),this.pdfDoc=null,this.pageNum=1,this.currentPageNum=1,this.totalPageNum=null,this.pageRendering=!1,this.pageNumPending=null,this.scale=1,this.canvas=null,this.viewport=null,this.PDFJS=PDFJS,this.zoom_in_scale=null,this.toolBarColor=e.color||"#3d464d",this.scroll=!1,this.scroll_browser_check=function(){var e=navigator.userAgent.toLowerCase();-1==e.indexOf("chrome")&&-1==e.indexOf("msie")||(this.scroll=!0)},this.update_pager=function(){var e=this.currentPageNum;this.target.querySelector(".current").innerHTML=e},this.set_pager=function(){var e=this.totalPageNum;this.target.querySelector(".total").innerHTML=e,this.update_pager()},this.handle_buttons=function(e){var t=this,n=e.target.getAttribute("data-button");if("prev"===n){if(1===t.currentPageNum)return;t.currentPageNum--,t.pdfDoc.getPage(t.currentPageNum).then(function(e){t.handlePages(e)}),t.update_pager()}if("next"===n){if(t.currentPageNum===t.totalPageNum)return;t.currentPageNum++,t.pdfDoc.getPage(t.currentPageNum).then(function(e){t.handlePages(e)}),t.update_pager()}if("download"===n){var i=document.createElement("a");i.href=t.url,i.download=t.url,i.click()}if("external"===n)window.open(t.url);"print"===n&&window.open(t.url).print();if("zoom_in"===n){if(t.scale>=2)return;t.zoom_in_scale+=.25,t.resize_render(t.zoom_in_scale)}if("zoom_out"===n){if(t.scale<1.2)return;t.zoom_in_scale-=.25,t.resize_render(t.zoom_in_scale)}"zoom_reset"===n&&(t.zoom_in_scale=0,t.resize_render(t.zoom_in_scale))},this.buttons_actions=this.handle_buttons.bind(this),this.viewer_buttons=function(){this.target.querySelector(".uxis-pdf-buttons").addEventListener("click",this.buttons_actions)},this.renderPage=function(e){var t=this;t.pdfDoc.getPage(1).then(function(e,n){t.handlePages(e,n)})},this.resize_handler=function(){var e=this;window.addEventListener("resize",debounce(function(){e.resize_render()},150))},this.resize_render=function(e){var t=this;t.target.querySelectorAll(".pdf-canvas").forEach(function(e){e.remove()}),"one"===this.mode?t.pdfDoc.getPage(t.currentPageNum).then(function(n){t.handlePages(n,e)}):t.pdfDoc.getPage(1).then(function(n){t.currentPageNum=1,t.handlePages(n,e)})},this.initUxisViewer=function(){var e=this;e.createFrame(),e.PDFJS.getDocument(this.url).then(function(t){e.pdfDoc=t,e.totalPageNum=t.numPages,"one"===e.mode&&e.set_pager(),e.viewer_buttons(),e.renderPage()})},this.handlePages=function(e,t){var n=this,i=document.createElement("canvas");i.style.display="block",i.classList.add("pdf-canvas"),1===n.currentPageNum&&n.scroll_browser_check?n.scale=(n.target.querySelector(".uxis-pdf-view .canvas-container").offsetWidth-16)/e.getViewport(1).width:n.scale=n.target.querySelector(".uxis-pdf-view .canvas-container").offsetWidth/e.getViewport(1).width,t&&(n.scale+=t),n.viewport=e.getViewport(n.scale);var a=i.getContext("2d");if(i.height=n.viewport.height,i.width=n.viewport.width,e.render({canvasContext:a,viewport:n.viewport}),"one"===n.mode){var r=n.target.querySelector(".pdf-canvas");r&&r.remove(),n.target.querySelector(".canvas-container").appendChild(i),null!==n.pageNumPending&&(n.handlePages(n.pageNumPending),n.pageNumPending=null)}else n.target.querySelector(".canvas-container").appendChild(i),n.currentPageNum++,null!==n.pdfDoc&&n.currentPageNum<=n.totalPageNum&&n.pdfDoc.getPage(n.currentPageNum).then(function(e){n.handlePages(e,t)})},this.init=function(){this.initUxisViewer(),this.resize_handler()},this.init()};UxisViewer.prototype.createButton=function(e){var t=document.createElement("div");t.classList.add("uxis-pdf-buttons");for(var n=e.length,i=0;i<n;i++){var a=e[i].action,r=e[i].title,o=document.createElement("button");o.classList.add("button_"+a),o.setAttribute("data-button",a),o.setAttribute("type","button"),o.setAttribute("title",r);var s=document.createElement("i");s.classList.add("hidden"),s.innerHTML=r,o.appendChild(s),t.appendChild(o)}return t},UxisViewer.prototype.createFrame=function(){var e=document.createElement("div");e.classList.add("uxis-viewer");var t=document.createElement("div");t.classList.add("uxis-toolbar"),t.style.backgroundColor=this.toolBarColor;var n=null;if("one"===this.mode){var i=document.createElement("div");i.classList.add("count"),i.innerHTML="<span class='current'></span> / <span class='total'></span>",t.appendChild(i),n=[{action:"prev",title:"이전페이지"},{action:"next",title:"다음페이지"},{action:"download",title:"다운로드"},{action:"external",title:"새창에서 보기"},{action:"print",title:"프린트"},{action:"zoom_in",title:"확대보기"},{action:"zoom_out",title:"축소하기"},{action:"zoom_reset",title:"RESET"}]}else n=[{action:"download",title:"다운로드"},{action:"external",title:"새창에서 보기"},{action:"print",title:"프린트"},{action:"zoom_in",title:"확대보기"},{action:"zoom_out",title:"축소하기"},{action:"zoom_reset",title:"RESET"}];var a=this.createButton(n),r=document.createElement("div");r.classList.add("uxis-pdf-container"),r.innerHTML='<div class="uxis-pdf-view"><div style="width:100%" class="canvas-container"></div></div>',t.appendChild(a),e.appendChild(t),e.appendChild(r),this.target.appendChild(e)};